<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ëŒ€íšŒ ê³µì§€ / ìƒí™©íŒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      padding: 16px;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
      margin-bottom: 16px;
    }
    .updated {
      text-align: right;
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
    }
    .notice-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .notice {
      background: #ffffff;
      border-radius: 8px;
      padding: 10px 12px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    .notice-time {
      font-size: 12px;
      color: #888;
      margin-bottom: 4px;
    }
    .notice-body {
      white-space: pre-wrap;
      font-size: 14px;
    }
    .small {
      font-size: 12px;
      color: #999;
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <h1>ê³µì§€ / ìƒí™©íŒ</h1>
  <div class="updated" id="updated">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  <div class="notice-list" id="notice-list">
    <!-- JSë¡œ ê³µì§€ê°€ ì¶”ê°€ë©ë‹ˆë‹¤ -->
  </div>
  <p class="small">â€» 10ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.</p>

  <script>
    // ğŸ‘‰ ì—¬ê¸°ë§Œ "board" íƒ­ì˜ CSV ì£¼ì†Œë¡œ ë°”ê¿”ì£¼ë©´ ë¨
    const NOTICES_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTqsmOlxzgGxrh91wGE0b92x3x40Ta1ZT2l0yd6rTKq5HsrZSng3qocNXwmypouA5F6H68HV46GPVHJ/pubhtml?gid=651255673&single=true"

    async function loadNotices() {
      try {
        const res = await fetch(NOTICES_CSV_URL + "&cachebuster=" + Date.now());
        const text = await res.text();

        const rows = text
          .trim()
          .split(/\r?\n/)
          .map(line => line.split(","));

        // rows[0] : 1í–‰(ë¹ˆì¤„)
        // rows[1] : 2í–‰(ë¹ˆì¤„)
        // rows[2] : 3í–‰(í—¤ë”: ê³µì§€ì‹œê°„ / ë‚´ìš© / ê³µê°œ ì—¬ë¶€)
        const dataRows = rows.slice(3);

        // [{ time, body, visible }, ...] ë¡œ ë³€í™˜
        let items = dataRows
          .map(cols => {
            const time   = (cols[1] ?? "").trim();  // Bì—´: ê³µì§€ì‹œê°„
            const body   = (cols[2] ?? "").trim();  // Cì—´: ë‚´ìš©
            const flag   = (cols[3] ?? "").trim();  // Dì—´: ê³µê°œ ì—¬ë¶€
            const visible = (flag === "1");
            return { time, body, visible };
          })
          // ë‚´ìš©ì´ ìˆê³  ê³µê°œ ì—¬ë¶€ê°€ 1ì¸ ê²ƒë§Œ ë³´ì—¬ì¤Œ
          .filter(item => item.body !== "" && item.visible);

        // ìµœì‹  ê³µì§€ê°€ ìœ„ë¡œ ì˜¤ë„ë¡ (ì‹œíŠ¸ì— ì•„ë˜ë¡œ ì¶”ê°€í•œë‹¤ê³  ê°€ì •)
        items = items.reverse();

        const container = document.getElementById("notice-list");
        container.innerHTML = "";

        if (items.length === 0) {
          container.innerHTML = "<div class='notice'>í˜„ì¬ í‘œì‹œí•  ê³µì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>";
        } else {
          items.forEach(item => {
            const div = document.createElement("div");
            div.className = "notice";
            div.innerHTML = `
              <div class="notice-time">${item.time}</div>
              <div class="notice-body">${item.body}</div>
            `;
            container.appendChild(div);
          });
        }

        const updated = document.getElementById("updated");
        const now = new Date();
        updated.textContent =
          "ë§ˆì§€ë§‰ ê°±ì‹ : " +
          now.toLocaleTimeString("ko-KR", { hour12: false });
      } catch (e) {
        console.error(e);
        document.getElementById("updated").textContent =
          "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
      }
    }

    loadNotices();
    // 10ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
    setInterval(loadNotices, 10000);
  </script>
</body>
</html>